see fig2a/snake_postprocess
